{"dependencies":[{"name":"./index.js","data":{"isAsync":false}},{"name":"inherits","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var index = _$$_REQUIRE(_dependencyMap[0], \"./index.js\"),\n      DomHandler = index.DomHandler,\n      DomUtils = index.DomUtils;\n\n  function FeedHandler(callback, options) {\n    this.init(callback, options);\n  }\n\n  _$$_REQUIRE(_dependencyMap[1], \"inherits\")(FeedHandler, DomHandler);\n\n  FeedHandler.prototype.init = DomHandler;\n\n  function getElements(what, where) {\n    return DomUtils.getElementsByTagName(what, where, true);\n  }\n\n  function getOneElement(what, where) {\n    return DomUtils.getElementsByTagName(what, where, true, 1)[0];\n  }\n\n  function fetch(what, where, recurse) {\n    return DomUtils.getText(DomUtils.getElementsByTagName(what, where, recurse, 1)).trim();\n  }\n\n  function addConditionally(obj, prop, what, where, recurse) {\n    var tmp = fetch(what, where, recurse);\n    if (tmp) obj[prop] = tmp;\n  }\n\n  var isValidFeed = function isValidFeed(value) {\n    return value === \"rss\" || value === \"feed\" || value === \"rdf:RDF\";\n  };\n\n  FeedHandler.prototype.onend = function () {\n    var feed = {},\n        feedRoot = getOneElement(isValidFeed, this.dom),\n        tmp,\n        childs;\n\n    if (feedRoot) {\n      if (feedRoot.name === \"feed\") {\n        childs = feedRoot.children;\n        feed.type = \"atom\";\n        addConditionally(feed, \"id\", \"id\", childs);\n        addConditionally(feed, \"title\", \"title\", childs);\n        if ((tmp = getOneElement(\"link\", childs)) && (tmp = tmp.attribs) && (tmp = tmp.href)) feed.link = tmp;\n        addConditionally(feed, \"description\", \"subtitle\", childs);\n        if (tmp = fetch(\"updated\", childs)) feed.updated = new Date(tmp);\n        addConditionally(feed, \"author\", \"email\", childs, true);\n        feed.items = getElements(\"entry\", childs).map(function (item) {\n          var entry = {},\n              tmp;\n          item = item.children;\n          addConditionally(entry, \"id\", \"id\", item);\n          addConditionally(entry, \"title\", \"title\", item);\n          if ((tmp = getOneElement(\"link\", item)) && (tmp = tmp.attribs) && (tmp = tmp.href)) entry.link = tmp;\n          if (tmp = fetch(\"summary\", item) || fetch(\"content\", item)) entry.description = tmp;\n          if (tmp = fetch(\"updated\", item)) entry.pubDate = new Date(tmp);\n          return entry;\n        });\n      } else {\n        childs = getOneElement(\"channel\", feedRoot.children).children;\n        feed.type = feedRoot.name.substr(0, 3);\n        feed.id = \"\";\n        addConditionally(feed, \"title\", \"title\", childs);\n        addConditionally(feed, \"link\", \"link\", childs);\n        addConditionally(feed, \"description\", \"description\", childs);\n        if (tmp = fetch(\"lastBuildDate\", childs)) feed.updated = new Date(tmp);\n        addConditionally(feed, \"author\", \"managingEditor\", childs, true);\n        feed.items = getElements(\"item\", feedRoot.children).map(function (item) {\n          var entry = {},\n              tmp;\n          item = item.children;\n          addConditionally(entry, \"id\", \"guid\", item);\n          addConditionally(entry, \"title\", \"title\", item);\n          addConditionally(entry, \"link\", \"link\", item);\n          addConditionally(entry, \"description\", \"description\", item);\n          if (tmp = fetch(\"pubDate\", item)) entry.pubDate = new Date(tmp);\n          return entry;\n        });\n      }\n    }\n\n    this.dom = feed;\n\n    DomHandler.prototype._handleCallback.call(this, feedRoot ? null : Error(\"couldn't find root of feed\"));\n  };\n\n  module.exports = FeedHandler;\n});","map":[[2,0,1,0],[2,6,1,4,"index"],[2,11,1,9],[2,14,1,12,"require"],[2,25,1,19],[2,58,1,0],[3,0,1,0],[3,6,2,4,"DomHandler"],[3,16,2,14],[3,19,2,17,"index"],[3,24,2,22],[3,25,2,23,"DomHandler"],[3,35,1,0],[4,0,1,0],[4,6,3,4,"DomUtils"],[4,14,3,12],[4,17,3,15,"index"],[4,22,3,20],[4,23,3,21,"DomUtils"],[4,31,1,0],[6,0,6,0],[6,11,6,9,"FeedHandler"],[6,22,6,0],[6,23,6,21,"callback"],[6,31,6,0],[6,33,6,31,"options"],[6,40,6,0],[6,42,6,39],[7,0,7,1],[7,9,7,6,"init"],[7,13,7,1],[7,14,7,11,"callback"],[7,22,7,1],[7,24,7,21,"options"],[7,31,7,1],[8,0,8,1],[10,0,10,0,"require"],[10,2,10,0,"require"],[10,13,10,7],[10,44,10,0],[10,45,10,20,"FeedHandler"],[10,56,10,0],[10,58,10,33,"DomHandler"],[10,68,10,0],[12,0,12,0,"FeedHandler"],[12,2,12,0,"FeedHandler"],[12,13,12,11],[12,14,12,12,"prototype"],[12,23,12,0],[12,24,12,22,"init"],[12,28,12,0],[12,31,12,29,"DomHandler"],[12,41,12,0],[14,0,14,0],[14,11,14,9,"getElements"],[14,22,14,0],[14,23,14,21,"what"],[14,27,14,0],[14,29,14,27,"where"],[14,34,14,0],[14,36,14,33],[15,0,15,1],[15,11,15,8,"DomUtils"],[15,19,15,16],[15,20,15,17,"getElementsByTagName"],[15,40,15,8],[15,41,15,38,"what"],[15,45,15,8],[15,47,15,44,"where"],[15,52,15,8],[15,54,15,51],[15,58,15,8],[15,59,15,1],[16,0,16,1],[18,0,17,0],[18,11,17,9,"getOneElement"],[18,24,17,0],[18,25,17,23,"what"],[18,29,17,0],[18,31,17,29,"where"],[18,36,17,0],[18,38,17,35],[19,0,18,1],[19,11,18,8,"DomUtils"],[19,19,18,16],[19,20,18,17,"getElementsByTagName"],[19,40,18,8],[19,41,18,38,"what"],[19,45,18,8],[19,47,18,44,"where"],[19,52,18,8],[19,54,18,51],[19,58,18,8],[19,60,18,57],[19,61,18,8],[19,63,18,60],[19,64,18,8],[19,65,18,1],[20,0,19,1],[22,0,20,0],[22,11,20,9,"fetch"],[22,16,20,0],[22,17,20,15,"what"],[22,21,20,0],[22,23,20,21,"where"],[22,28,20,0],[22,30,20,28,"recurse"],[22,37,20,0],[22,39,20,36],[23,0,21,1],[23,11,21,8,"DomUtils"],[23,19,21,16],[23,20,21,17,"getText"],[23,27,21,8],[23,28,22,2,"DomUtils"],[23,36,22,10],[23,37,22,11,"getElementsByTagName"],[23,57,22,2],[23,58,22,32,"what"],[23,62,22,2],[23,64,22,38,"where"],[23,69,22,2],[23,71,22,45,"recurse"],[23,78,22,2],[23,80,22,54],[23,81,22,2],[23,82,21,8],[23,84,23,3,"trim"],[23,88,21,8],[23,90,21,1],[24,0,24,1],[26,0,26,0],[26,11,26,9,"addConditionally"],[26,27,26,0],[26,28,26,26,"obj"],[26,31,26,0],[26,33,26,31,"prop"],[26,37,26,0],[26,39,26,37,"what"],[26,43,26,0],[26,45,26,43,"where"],[26,50,26,0],[26,52,26,50,"recurse"],[26,59,26,0],[26,61,26,58],[27,0,27,1],[27,8,27,5,"tmp"],[27,11,27,8],[27,14,27,11,"fetch"],[27,19,27,16],[27,20,27,17,"what"],[27,24,27,16],[27,26,27,23,"where"],[27,31,27,16],[27,33,27,30,"recurse"],[27,40,27,16],[27,41,27,1],[28,0,28,1],[28,8,28,4,"tmp"],[28,11,28,1],[28,13,28,9,"obj"],[28,16,28,12],[28,17,28,13,"prop"],[28,21,28,12],[28,22,28,9],[28,25,28,21,"tmp"],[28,28,28,9],[29,0,29,1],[31,0,31,0],[31,6,31,4,"isValidFeed"],[31,17,31,15],[31,20,31,18],[31,29,31,4,"isValidFeed"],[31,40,31,18],[31,41,31,27,"value"],[31,46,31,18],[31,48,31,33],[32,0,32,1],[32,11,32,8,"value"],[32,16,32,13],[32,21,32,18],[32,26,32,8],[32,30,32,27,"value"],[32,35,32,32],[32,40,32,37],[32,46,32,8],[32,50,32,47,"value"],[32,55,32,52],[32,60,32,57],[32,69,32,1],[33,0,33,1],[33,3,31,0],[35,0,35,0,"FeedHandler"],[35,2,35,0,"FeedHandler"],[35,13,35,11],[35,14,35,12,"prototype"],[35,23,35,0],[35,24,35,22,"onend"],[35,29,35,0],[35,32,35,30],[35,44,35,40],[36,0,36,1],[36,8,36,5,"feed"],[36,12,36,9],[36,15,36,12],[36,17,36,1],[37,0,36,1],[37,8,37,5,"feedRoot"],[37,16,37,13],[37,19,37,16,"getOneElement"],[37,32,37,29],[37,33,37,30,"isValidFeed"],[37,44,37,29],[37,46,37,43],[37,51,37,48,"dom"],[37,54,37,29],[37,55,36,1],[38,0,36,1],[38,8,38,5,"tmp"],[38,11,36,1],[39,0,36,1],[39,8,38,10,"childs"],[39,14,36,1],[41,0,40,1],[41,8,40,4,"feedRoot"],[41,16,40,1],[41,18,40,13],[42,0,41,2],[42,10,41,5,"feedRoot"],[42,18,41,13],[42,19,41,14,"name"],[42,23,41,5],[42,28,41,23],[42,34,41,2],[42,36,41,30],[43,0,42,3,"childs"],[43,8,42,3,"childs"],[43,14,42,9],[43,17,42,12,"feedRoot"],[43,25,42,20],[43,26,42,21,"children"],[43,34,42,3],[44,0,44,3,"feed"],[44,8,44,3,"feed"],[44,12,44,7],[44,13,44,8,"type"],[44,17,44,3],[44,20,44,15],[44,26,44,3],[45,0,45,3,"addConditionally"],[45,8,45,3,"addConditionally"],[45,24,45,19],[45,25,45,20,"feed"],[45,29,45,19],[45,31,45,26],[45,35,45,19],[45,37,45,32],[45,41,45,19],[45,43,45,38,"childs"],[45,49,45,19],[45,50,45,3],[46,0,46,3,"addConditionally"],[46,8,46,3,"addConditionally"],[46,24,46,19],[46,25,46,20,"feed"],[46,29,46,19],[46,31,46,26],[46,38,46,19],[46,40,46,35],[46,47,46,19],[46,49,46,44,"childs"],[46,55,46,19],[46,56,46,3],[47,0,47,3],[47,12,47,6],[47,13,47,7,"tmp"],[47,16,47,10],[47,19,47,13,"getOneElement"],[47,32,47,26],[47,33,47,27],[47,39,47,26],[47,41,47,35,"childs"],[47,47,47,26],[47,48,47,6],[47,54,47,48,"tmp"],[47,57,47,51],[47,60,47,54,"tmp"],[47,63,47,57],[47,64,47,58,"attribs"],[47,71,47,6],[47,77,47,71,"tmp"],[47,80,47,74],[47,83,47,77,"tmp"],[47,86,47,80],[47,87,47,81,"href"],[47,91,47,6],[47,92,47,3],[47,94,47,88,"feed"],[47,98,47,92],[47,99,47,93,"link"],[47,103,47,88],[47,106,47,100,"tmp"],[47,109,47,88],[48,0,48,3,"addConditionally"],[48,8,48,3,"addConditionally"],[48,24,48,19],[48,25,48,20,"feed"],[48,29,48,19],[48,31,48,26],[48,44,48,19],[48,46,48,41],[48,56,48,19],[48,58,48,53,"childs"],[48,64,48,19],[48,65,48,3],[49,0,49,3],[49,12,49,7,"tmp"],[49,15,49,10],[49,18,49,13,"fetch"],[49,23,49,18],[49,24,49,19],[49,33,49,18],[49,35,49,30,"childs"],[49,41,49,18],[49,42,49,3],[49,44,49,40,"feed"],[49,48,49,44],[49,49,49,45,"updated"],[49,56,49,40],[49,59,49,55],[49,63,49,59,"Date"],[49,67,49,55],[49,68,49,64,"tmp"],[49,71,49,55],[49,72,49,40],[50,0,50,3,"addConditionally"],[50,8,50,3,"addConditionally"],[50,24,50,19],[50,25,50,20,"feed"],[50,29,50,19],[50,31,50,26],[50,39,50,19],[50,41,50,36],[50,48,50,19],[50,50,50,45,"childs"],[50,56,50,19],[50,58,50,53],[50,62,50,19],[50,63,50,3],[51,0,52,3,"feed"],[51,8,52,3,"feed"],[51,12,52,7],[51,13,52,8,"items"],[51,18,52,3],[51,21,52,16,"getElements"],[51,32,52,27],[51,33,52,28],[51,40,52,27],[51,42,52,37,"childs"],[51,48,52,27],[51,49,52,16],[51,50,52,45,"map"],[51,53,52,16],[51,54,52,49],[51,64,52,58,"item"],[51,68,52,49],[51,70,52,63],[52,0,53,4],[52,14,53,8,"entry"],[52,19,53,13],[52,22,53,16],[52,24,53,4],[53,0,53,4],[53,14,53,20,"tmp"],[53,17,53,4],[54,0,55,4,"item"],[54,10,55,4,"item"],[54,14,55,8],[54,17,55,11,"item"],[54,21,55,15],[54,22,55,16,"children"],[54,30,55,4],[55,0,57,4,"addConditionally"],[55,10,57,4,"addConditionally"],[55,26,57,20],[55,27,57,21,"entry"],[55,32,57,20],[55,34,57,28],[55,38,57,20],[55,40,57,34],[55,44,57,20],[55,46,57,40,"item"],[55,50,57,20],[55,51,57,4],[56,0,58,4,"addConditionally"],[56,10,58,4,"addConditionally"],[56,26,58,20],[56,27,58,21,"entry"],[56,32,58,20],[56,34,58,28],[56,41,58,20],[56,43,58,37],[56,50,58,20],[56,52,58,46,"item"],[56,56,58,20],[56,57,58,4],[57,0,59,4],[57,14,59,7],[57,15,59,8,"tmp"],[57,18,59,11],[57,21,59,14,"getOneElement"],[57,34,59,27],[57,35,59,28],[57,41,59,27],[57,43,59,36,"item"],[57,47,59,27],[57,48,59,7],[57,54,59,47,"tmp"],[57,57,59,50],[57,60,59,53,"tmp"],[57,63,59,56],[57,64,59,57,"attribs"],[57,71,59,7],[57,77,59,70,"tmp"],[57,80,59,73],[57,83,59,76,"tmp"],[57,86,59,79],[57,87,59,80,"href"],[57,91,59,7],[57,92,59,4],[57,94,59,87,"entry"],[57,99,59,92],[57,100,59,93,"link"],[57,104,59,87],[57,107,59,100,"tmp"],[57,110,59,87],[58,0,60,4],[58,14,60,8,"tmp"],[58,17,60,11],[58,20,60,14,"fetch"],[58,25,60,19],[58,26,60,20],[58,35,60,19],[58,37,60,31,"item"],[58,41,60,19],[58,42,60,14],[58,46,60,40,"fetch"],[58,51,60,45],[58,52,60,46],[58,61,60,45],[58,63,60,57,"item"],[58,67,60,45],[58,68,60,4],[58,70,60,65,"entry"],[58,75,60,70],[58,76,60,71,"description"],[58,87,60,65],[58,90,60,85,"tmp"],[58,93,60,65],[59,0,61,4],[59,14,61,8,"tmp"],[59,17,61,11],[59,20,61,14,"fetch"],[59,25,61,19],[59,26,61,20],[59,35,61,19],[59,37,61,31,"item"],[59,41,61,19],[59,42,61,4],[59,44,61,39,"entry"],[59,49,61,44],[59,50,61,45,"pubDate"],[59,57,61,39],[59,60,61,55],[59,64,61,59,"Date"],[59,68,61,55],[59,69,61,64,"tmp"],[59,72,61,55],[59,73,61,39],[60,0,62,4],[60,17,62,11,"entry"],[60,22,62,4],[61,0,63,4],[61,9,52,16],[61,10,52,3],[62,0,64,3],[62,7,41,2],[62,13,64,9],[63,0,65,3,"childs"],[63,8,65,3,"childs"],[63,14,65,9],[63,17,65,12,"getOneElement"],[63,30,65,25],[63,31,65,26],[63,40,65,25],[63,42,65,37,"feedRoot"],[63,50,65,45],[63,51,65,46,"children"],[63,59,65,25],[63,60,65,12],[63,61,65,56,"children"],[63,69,65,3],[64,0,67,3,"feed"],[64,8,67,3,"feed"],[64,12,67,7],[64,13,67,8,"type"],[64,17,67,3],[64,20,67,15,"feedRoot"],[64,28,67,23],[64,29,67,24,"name"],[64,33,67,15],[64,34,67,29,"substr"],[64,40,67,15],[64,41,67,36],[64,42,67,15],[64,44,67,39],[64,45,67,15],[64,46,67,3],[65,0,68,3,"feed"],[65,8,68,3,"feed"],[65,12,68,7],[65,13,68,8,"id"],[65,15,68,3],[65,18,68,13],[65,20,68,3],[66,0,69,3,"addConditionally"],[66,8,69,3,"addConditionally"],[66,24,69,19],[66,25,69,20,"feed"],[66,29,69,19],[66,31,69,26],[66,38,69,19],[66,40,69,35],[66,47,69,19],[66,49,69,44,"childs"],[66,55,69,19],[66,56,69,3],[67,0,70,3,"addConditionally"],[67,8,70,3,"addConditionally"],[67,24,70,19],[67,25,70,20,"feed"],[67,29,70,19],[67,31,70,26],[67,37,70,19],[67,39,70,34],[67,45,70,19],[67,47,70,42,"childs"],[67,53,70,19],[67,54,70,3],[68,0,71,3,"addConditionally"],[68,8,71,3,"addConditionally"],[68,24,71,19],[68,25,71,20,"feed"],[68,29,71,19],[68,31,71,26],[68,44,71,19],[68,46,71,41],[68,59,71,19],[68,61,71,56,"childs"],[68,67,71,19],[68,68,71,3],[69,0,72,3],[69,12,72,7,"tmp"],[69,15,72,10],[69,18,72,13,"fetch"],[69,23,72,18],[69,24,72,19],[69,39,72,18],[69,41,72,36,"childs"],[69,47,72,18],[69,48,72,3],[69,50,72,46,"feed"],[69,54,72,50],[69,55,72,51,"updated"],[69,62,72,46],[69,65,72,61],[69,69,72,65,"Date"],[69,73,72,61],[69,74,72,70,"tmp"],[69,77,72,61],[69,78,72,46],[70,0,73,3,"addConditionally"],[70,8,73,3,"addConditionally"],[70,24,73,19],[70,25,73,20,"feed"],[70,29,73,19],[70,31,73,26],[70,39,73,19],[70,41,73,36],[70,57,73,19],[70,59,73,54,"childs"],[70,65,73,19],[70,67,73,62],[70,71,73,19],[70,72,73,3],[71,0,75,3,"feed"],[71,8,75,3,"feed"],[71,12,75,7],[71,13,75,8,"items"],[71,18,75,3],[71,21,75,16,"getElements"],[71,32,75,27],[71,33,75,28],[71,39,75,27],[71,41,75,36,"feedRoot"],[71,49,75,44],[71,50,75,45,"children"],[71,58,75,27],[71,59,75,16],[71,60,75,55,"map"],[71,63,75,16],[71,64,75,59],[71,74,75,68,"item"],[71,78,75,59],[71,80,75,73],[72,0,76,4],[72,14,76,8,"entry"],[72,19,76,13],[72,22,76,16],[72,24,76,4],[73,0,76,4],[73,14,76,20,"tmp"],[73,17,76,4],[74,0,78,4,"item"],[74,10,78,4,"item"],[74,14,78,8],[74,17,78,11,"item"],[74,21,78,15],[74,22,78,16,"children"],[74,30,78,4],[75,0,80,4,"addConditionally"],[75,10,80,4,"addConditionally"],[75,26,80,20],[75,27,80,21,"entry"],[75,32,80,20],[75,34,80,28],[75,38,80,20],[75,40,80,34],[75,46,80,20],[75,48,80,42,"item"],[75,52,80,20],[75,53,80,4],[76,0,81,4,"addConditionally"],[76,10,81,4,"addConditionally"],[76,26,81,20],[76,27,81,21,"entry"],[76,32,81,20],[76,34,81,28],[76,41,81,20],[76,43,81,37],[76,50,81,20],[76,52,81,46,"item"],[76,56,81,20],[76,57,81,4],[77,0,82,4,"addConditionally"],[77,10,82,4,"addConditionally"],[77,26,82,20],[77,27,82,21,"entry"],[77,32,82,20],[77,34,82,28],[77,40,82,20],[77,42,82,36],[77,48,82,20],[77,50,82,44,"item"],[77,54,82,20],[77,55,82,4],[78,0,83,4,"addConditionally"],[78,10,83,4,"addConditionally"],[78,26,83,20],[78,27,83,21,"entry"],[78,32,83,20],[78,34,83,28],[78,47,83,20],[78,49,83,43],[78,62,83,20],[78,64,83,58,"item"],[78,68,83,20],[78,69,83,4],[79,0,84,4],[79,14,84,8,"tmp"],[79,17,84,11],[79,20,84,14,"fetch"],[79,25,84,19],[79,26,84,20],[79,35,84,19],[79,37,84,31,"item"],[79,41,84,19],[79,42,84,4],[79,44,84,39,"entry"],[79,49,84,44],[79,50,84,45,"pubDate"],[79,57,84,39],[79,60,84,55],[79,64,84,59,"Date"],[79,68,84,55],[79,69,84,64,"tmp"],[79,72,84,55],[79,73,84,39],[80,0,85,4],[80,17,85,11,"entry"],[80,22,85,4],[81,0,86,4],[81,9,75,16],[81,10,75,3],[82,0,87,3],[83,0,88,2],[85,0,89,1],[85,9,89,6,"dom"],[85,12,89,1],[85,15,89,12,"feed"],[85,19,89,1],[87,0,90,1,"DomHandler"],[87,4,90,1,"DomHandler"],[87,14,90,11],[87,15,90,12,"prototype"],[87,24,90,1],[87,25,90,22,"_handleCallback"],[87,40,90,1],[87,41,90,38,"call"],[87,45,90,1],[87,46,91,2],[87,50,90,1],[87,52,91,8,"feedRoot"],[87,60,91,16],[87,63,91,19],[87,67,91,16],[87,70,91,26,"Error"],[87,75,91,31],[87,76,91,32],[87,104,91,31],[87,105,90,1],[88,0,93,1],[88,3,35,0],[90,0,95,0,"module"],[90,2,95,0,"module"],[90,8,95,6],[90,9,95,7,"exports"],[90,16,95,0],[90,19,95,17,"FeedHandler"],[90,30,95,0]]},"type":"js/module"}]}